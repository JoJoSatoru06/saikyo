const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C8UCDmIS.js","assets/index-BSW9cB0O.css"])))=>i.map(i=>d[i]);
import{w as X,c as ee,r as x,u as L,j as e,x as te,P as E,b as se,a as ne,y as Oe,R as m,z as Fe,A as ke,f as I,B as Te,l as N,g as V,D as G,_ as W,m as Me,E as Le,M as oe,G as Z,i as re,H as ae,F as ie,I as Ve}from"./index-C8UCDmIS.js";import{P as Ge,a as We,b as $,B as _,t as z,S as ce,c as le,d as de,e as ue,g as pe,f as xe,h as $e,i as ze,j as He}from"./try-catch-EVrbK3BY.js";import{A as Ue,a as qe,b as Be,c as Qe,d as Ke,e as Ye,f as Ze,g as he,B as T,D as Je,h as Xe,E as et,i as tt,j as J,S as st,T as nt}from"./zod-cA25T081.js";const ot=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],rt=X("user",ot);const at=[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]],it=X("weight",at);var P="Collapsible",[ct,me]=ee(P),[lt,H]=ct(P),fe=x.forwardRef((t,n)=>{const{__scopeCollapsible:s,open:o,defaultOpen:r,disabled:a,onOpenChange:i,...c}=t,[l,d]=L({prop:o,defaultProp:r??!1,onChange:i,caller:P});return e.jsx(lt,{scope:s,disabled:a,contentId:te(),open:l,onOpenToggle:x.useCallback(()=>d(p=>!p),[d]),children:e.jsx(E.div,{"data-state":q(l),"data-disabled":a?"":void 0,...c,ref:n})})});fe.displayName=P;var ge="CollapsibleTrigger",be=x.forwardRef((t,n)=>{const{__scopeCollapsible:s,...o}=t,r=H(ge,s);return e.jsx(E.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":q(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...o,ref:n,onClick:se(t.onClick,r.onOpenToggle)})});be.displayName=ge;var U="CollapsibleContent",ve=x.forwardRef((t,n)=>{const{forceMount:s,...o}=t,r=H(U,t.__scopeCollapsible);return e.jsx(Ge,{present:s||r.open,children:({present:a})=>e.jsx(dt,{...o,ref:n,present:a})})});ve.displayName=U;var dt=x.forwardRef((t,n)=>{const{__scopeCollapsible:s,present:o,children:r,...a}=t,i=H(U,s),[c,l]=x.useState(o),d=x.useRef(null),p=ne(n,d),h=x.useRef(0),b=h.current,f=x.useRef(0),A=f.current,v=i.open||c,j=x.useRef(v),C=x.useRef(void 0);return x.useEffect(()=>{const u=requestAnimationFrame(()=>j.current=!1);return()=>cancelAnimationFrame(u)},[]),Oe(()=>{const u=d.current;if(u){C.current=C.current||{transitionDuration:u.style.transitionDuration,animationName:u.style.animationName},u.style.transitionDuration="0s",u.style.animationName="none";const y=u.getBoundingClientRect();h.current=y.height,f.current=y.width,j.current||(u.style.transitionDuration=C.current.transitionDuration,u.style.animationName=C.current.animationName),l(o)}},[i.open,o]),e.jsx(E.div,{"data-state":q(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!v,...a,ref:p,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":A?`${A}px`:void 0,...t.style},children:v&&r})});function q(t){return t?"open":"closed"}var ut=fe,pt=be,xt=ve,g="Accordion",ht=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[B,mt,ft]=Fe(g),[D]=ee(g,[ft,me]),Q=me(),je=m.forwardRef((t,n)=>{const{type:s,...o}=t,r=o,a=o;return e.jsx(B.Provider,{scope:t.__scopeAccordion,children:s==="multiple"?e.jsx(jt,{...a,ref:n}):e.jsx(vt,{...r,ref:n})})});je.displayName=g;var[Ce,gt]=D(g),[Ae,bt]=D(g,{collapsible:!1}),vt=m.forwardRef((t,n)=>{const{value:s,defaultValue:o,onValueChange:r=()=>{},collapsible:a=!1,...i}=t,[c,l]=L({prop:s,defaultProp:o??"",onChange:r,caller:g});return e.jsx(Ce,{scope:t.__scopeAccordion,value:m.useMemo(()=>c?[c]:[],[c]),onItemOpen:l,onItemClose:m.useCallback(()=>a&&l(""),[a,l]),children:e.jsx(Ae,{scope:t.__scopeAccordion,collapsible:a,children:e.jsx(ye,{...i,ref:n})})})}),jt=m.forwardRef((t,n)=>{const{value:s,defaultValue:o,onValueChange:r=()=>{},...a}=t,[i,c]=L({prop:s,defaultProp:o??[],onChange:r,caller:g}),l=m.useCallback(p=>c((h=[])=>[...h,p]),[c]),d=m.useCallback(p=>c((h=[])=>h.filter(b=>b!==p)),[c]);return e.jsx(Ce,{scope:t.__scopeAccordion,value:i,onItemOpen:l,onItemClose:d,children:e.jsx(Ae,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(ye,{...a,ref:n})})})}),[Ct,R]=D(g),ye=m.forwardRef((t,n)=>{const{__scopeAccordion:s,disabled:o,dir:r,orientation:a="vertical",...i}=t,c=m.useRef(null),l=ne(c,n),d=mt(s),h=ke(r)==="ltr",b=se(t.onKeyDown,f=>{if(!ht.includes(f.key))return;const A=f.target,v=d().filter(k=>!k.ref.current?.disabled),j=v.findIndex(k=>k.ref.current===A),C=v.length;if(j===-1)return;f.preventDefault();let u=j;const y=0,S=C-1,O=()=>{u=j+1,u>S&&(u=y)},F=()=>{u=j-1,u<y&&(u=S)};switch(f.key){case"Home":u=y;break;case"End":u=S;break;case"ArrowRight":a==="horizontal"&&(h?O():F());break;case"ArrowDown":a==="vertical"&&O();break;case"ArrowLeft":a==="horizontal"&&(h?F():O());break;case"ArrowUp":a==="vertical"&&F();break}const Se=u%C;v[Se].ref.current?.focus()});return e.jsx(Ct,{scope:s,disabled:o,direction:r,orientation:a,children:e.jsx(B.Slot,{scope:s,children:e.jsx(E.div,{...i,"data-orientation":a,ref:l,onKeyDown:o?void 0:b})})})}),w="AccordionItem",[At,K]=D(w),Ee=m.forwardRef((t,n)=>{const{__scopeAccordion:s,value:o,...r}=t,a=R(w,s),i=gt(w,s),c=Q(s),l=te(),d=o&&i.value.includes(o)||!1,p=a.disabled||t.disabled;return e.jsx(At,{scope:s,open:d,disabled:p,triggerId:l,children:e.jsx(ut,{"data-orientation":a.orientation,"data-state":De(d),...c,...r,ref:n,disabled:p,open:d,onOpenChange:h=>{h?i.onItemOpen(o):i.onItemClose(o)}})})});Ee.displayName=w;var Ne="AccordionHeader",_e=m.forwardRef((t,n)=>{const{__scopeAccordion:s,...o}=t,r=R(g,s),a=K(Ne,s);return e.jsx(E.h3,{"data-orientation":r.orientation,"data-state":De(a.open),"data-disabled":a.disabled?"":void 0,...o,ref:n})});_e.displayName=Ne;var M="AccordionTrigger",we=m.forwardRef((t,n)=>{const{__scopeAccordion:s,...o}=t,r=R(g,s),a=K(M,s),i=bt(M,s),c=Q(s);return e.jsx(B.ItemSlot,{scope:s,children:e.jsx(pt,{"aria-disabled":a.open&&!i.collapsible||void 0,"data-orientation":r.orientation,id:a.triggerId,...c,...o,ref:n})})});we.displayName=M;var Ie="AccordionContent",Pe=m.forwardRef((t,n)=>{const{__scopeAccordion:s,...o}=t,r=R(g,s),a=K(Ie,s),i=Q(s);return e.jsx(xt,{role:"region","aria-labelledby":a.triggerId,"data-orientation":r.orientation,...i,...o,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});Pe.displayName=Ie;function De(t){return t?"open":"closed"}var yt=je,Et=Ee,Nt=_e,_t=we,wt=Pe;const It=({...t})=>e.jsx(yt,{"data-slot":"accordion",...t}),Pt=({className:t,...n})=>e.jsx(Et,{"data-slot":"accordion-item",className:I("border-b last:border-b-0",t),...n}),Dt=({className:t,children:n,...s})=>e.jsx(Nt,{className:"flex",children:e.jsxs(_t,{"data-slot":"accordion-trigger",className:I("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",t),...s,children:[n,e.jsx(Te,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})}),Rt=({className:t,children:n,...s})=>e.jsx(wt,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...s,children:e.jsx("div",{className:I("pt-0 pb-4",t),children:n})}),Y=()=>We(N.getAll())>0,St=({exercise:t,...n})=>{const s=V(),o=Y(),{mutateAsync:r,isPending:a}=$({mutationFn:G.delete}),i=async()=>{const{toast:c}=await W(async()=>{const{toast:d}=await import("./index-C8UCDmIS.js").then(p=>p.au);return{toast:d}},__vite__mapDeps([0,1])),{error:l}=await z(r(t.id));if(l){c.error(l.message);return}await s.invalidateQueries(N.getAll()),c.success(`Упражнение «${t.name}» удалено`)};return e.jsx(Ue,{...n,children:e.jsxs(qe,{children:[e.jsxs(Be,{children:[e.jsxs(Qe,{children:["Удалить упражнение «",t.name,"»?"]}),e.jsx(Ke,{children:"Это действие не может быть отменено. Это удалит упражнение навсегда."})]}),e.jsxs(Ye,{children:[e.jsx(Ze,{children:"Отмена"}),e.jsx(_,{loading:a||o,onClick:i,children:"Удалить"})]})]})})},Re=({form:t})=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{control:t.control,name:"name",label:"Название",description:"Например: Жим лежа",inputProps:{placeholder:"Например: Жим лежа"}}),e.jsx(Le,{control:t.control,name:"muscleGroup",label:"Группа мышц",options:oe}),e.jsx(Z,{control:t.control,name:"doubleWeight",label:"Удвоить вес",description:"Например: для гантелей",switchProps:{onCheckedChange:()=>{t.setValue("bodyWeight",!1,{shouldDirty:!0})}}}),e.jsx(Z,{control:t.control,name:"bodyWeight",label:"Собственный вес",description:"Например: для подтягиваний, отжиманий с собственным весом",switchProps:{onCheckedChange:()=>{t.setValue("doubleWeight",!1,{shouldDirty:!0})}}})]}),Ot=({exercise:t,...n})=>e.jsx(ce,{...n,children:e.jsxs(le,{side:"bottom",className:"h-[80dvh] rounded-t-xl",children:[e.jsx(de,{children:e.jsx(ue,{children:"Изменить упражнение"})}),e.jsx(Ft,{exercise:t,onOpenChange:n?.onOpenChange})]})}),Ft=({exercise:t,onOpenChange:n})=>{const s=x.useId(),o=V(),r=Y(),{mutateAsync:a,isPending:i}=$({mutationFn:G.update}),c=re({resolver:he(ae),defaultValues:{name:t.name,muscleGroup:t.muscleGroup.value,doubleWeight:t.doubleWeight,bodyWeight:t.bodyWeight}}),l=async d=>{const{toast:p}=await W(async()=>{const{toast:f}=await import("./index-C8UCDmIS.js").then(A=>A.au);return{toast:f}},__vite__mapDeps([0,1])),{error:h,response:b}=await z(a({id:t.id,dto:d}));if(h){p.error(h.message);return}await o.invalidateQueries(N.getAll()),p.success(`Упражнение «${b.data.name}» изменено`),n?.(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-full flex-1 min-h-0",children:e.jsx(ie,{...c,children:e.jsx("form",{id:s,onSubmit:c.handleSubmit(l),className:"px-4 space-y-6 h-full flex flex-col",children:e.jsx(Re,{form:c})})})}),e.jsx(xe,{className:"mt-auto",children:e.jsx(_,{className:"w-full",type:"submit",loading:i||r,form:s,children:"Изменить"})})]})},kt=({exercise:t,className:n,...s})=>e.jsxs("div",{className:I("flex items-center justify-between gap-2 p-3 rounded-md bg-secondary/50 border border-border/50",n),...s,children:[e.jsx("span",{className:"font-medium",children:t.name}),e.jsxs("div",{className:"flex gap-2 items-center",children:[t.doubleWeight&&e.jsxs(T,{variant:"default",children:[e.jsx(it,{className:"size-3"}),e.jsx("span",{children:"x2"})]}),t.bodyWeight&&e.jsxs(T,{variant:"default",children:[e.jsx(rt,{className:"size-3"}),e.jsx("span",{children:"Свой"})]}),e.jsx(Tt,{exercise:t})]})]},t.id),Tt=({exercise:t})=>{const[n,s]=x.useState(!1),[o,r]=x.useState(!1),a=()=>{s(!0)},i=()=>{r(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(Je,{children:[e.jsx(Xe,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",children:e.jsx(et,{})})}),e.jsxs(tt,{side:"bottom",align:"end",children:[e.jsxs(J,{onClick:a,children:[e.jsx(st,{className:"size-4"}),"Изменить"]}),e.jsxs(J,{variant:"destructive",onClick:i,children:[e.jsx(nt,{className:"size-4"}),"Удалить"]})]})]}),e.jsx(Ot,{exercise:t,open:n,onOpenChange:s}),e.jsx(St,{exercise:t,open:o,onOpenChange:r})]})},Mt=()=>{const t=$e(N.getAll()),n=s=>t.data?.filter(o=>o.muscleGroup.value===s.value)??[];return e.jsx(e.Fragment,{children:e.jsx(It,{type:"multiple",className:"w-full space-y-2",children:oe.map(s=>{const o=n(s);return e.jsxs(Pt,{value:s.value,className:"border rounded-lg px-2 bg-card",children:[e.jsx(Dt,{className:"hover:no-underline py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:s.label}),e.jsx(T,{variant:"secondary",children:o.length})]})}),e.jsx(Rt,{className:"pb-4 space-y-2",children:o.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:"Нет упражнений в этой группе"}):o.map(r=>e.jsx(kt,{exercise:r},r.id))})]},s.value)})})})},Lt=()=>{const[t,n]=x.useState(!1);return e.jsxs(ce,{open:t,onOpenChange:n,children:[e.jsx(ze,{asChild:!0,children:e.jsx(_,{size:"icon",children:e.jsx(He,{})})}),e.jsxs(le,{side:"bottom",className:"h-[80vh] rounded-t-xl",children:[e.jsx(de,{className:"border-b",children:e.jsx(ue,{children:"Добавить упражнение"})}),e.jsx(Vt,{setOpen:n})]})]})},Vt=({setOpen:t})=>{const n=x.useId(),s=V(),o=Y(),{mutateAsync:r,isPending:a}=$({mutationFn:G.create}),i=re({resolver:he(ae),defaultValues:{name:"",muscleGroup:Ve.chest.value,doubleWeight:!1,bodyWeight:!1}}),c=async l=>{const{toast:d}=await W(async()=>{const{toast:b}=await import("./index-C8UCDmIS.js").then(f=>f.au);return{toast:b}},__vite__mapDeps([0,1])),{error:p,response:h}=await z(r(l));if(p){d.error(p.message);return}await s.invalidateQueries(N.getAll()),d.success(`Упражнение «${h.data.name}» добавлено`),t(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-full flex-1 min-h-0",children:e.jsx(ie,{...i,children:e.jsx("form",{id:n,onSubmit:i.handleSubmit(c),className:"px-4 h-full flex flex-col gap-6",children:e.jsx(Re,{form:i})})})}),e.jsx(xe,{className:"border-t",children:e.jsx(_,{className:"w-full",type:"submit",loading:a||o,form:n,children:"Сохранить"})})]})},zt=()=>e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between sticky top-0 bg-background z-10 py-4",children:[e.jsx("h1",{className:"text-h2",children:"Упражнения"}),e.jsx(Lt,{})]}),e.jsx(Mt,{})]});export{zt as component};
