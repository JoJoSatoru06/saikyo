const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CzvuFs9p.js","assets/index-BSW9cB0O.css"])))=>i.map(i=>d[i]);
import{r as h,j as e,c as ge,P as _,u as fe,a as q,b as B,d as je,e as be,f as T,C as Ce,L as ve,t as k,g as F,h as I,_ as A,i as z,k as ke,l as V,F as H,m as $,n as U,o as G,p as K,q as X,s as J,v as ye}from"./index-CzvuFs9p.js";import{u as Ne,Q as we,P as Se,a as Pe,b as D,B as y,t as R,S as W,c as Y,d as Z,e as ee,f as se,g as N,h as Ee,i as _e,j as Te}from"./try-catch-74CgNQul.js";import{A as Fe,a as Ie,b as Ae,c as De,d as Re,e as Oe,f as Qe,g as te,B as w,D as Me,h as Be,E as Le,i as qe,j as L,S as ze,T as Ve}from"./zod-BXPw5ul5.js";import{C as He,a as $e,b as Ue,c as Ge,d as Ke}from"./card-CyI4ufnx.js";function re(s,r){return Ne(s,we)}var S="Checkbox",[Xe]=ge(S),[Je,O]=Xe(S);function We(s){const{__scopeCheckbox:r,checked:a,children:o,defaultChecked:t,disabled:n,form:i,name:c,onCheckedChange:d,required:u,value:l="on",internal_do_not_use_render:x}=s,[m,j]=fe({prop:a,defaultProp:t??!1,onChange:d,caller:S}),[f,b]=h.useState(null),[v,p]=h.useState(null),g=h.useRef(!1),P=f?!!i||!!f.closest("form"):!0,E={checked:m,disabled:n,setChecked:j,control:f,setControl:b,name:c,form:i,value:l,hasConsumerStoppedPropagationRef:g,required:u,defaultChecked:C(t)?!1:t,isFormControl:P,bubbleInput:v,setBubbleInput:p};return e.jsx(Je,{scope:r,...E,children:Ye(x)?x(E):o})}var ne="CheckboxTrigger",ae=h.forwardRef(({__scopeCheckbox:s,onKeyDown:r,onClick:a,...o},t)=>{const{control:n,value:i,disabled:c,checked:d,required:u,setControl:l,setChecked:x,hasConsumerStoppedPropagationRef:m,isFormControl:j,bubbleInput:f}=O(ne,s),b=q(t,l),v=h.useRef(d);return h.useEffect(()=>{const p=n?.form;if(p){const g=()=>x(v.current);return p.addEventListener("reset",g),()=>p.removeEventListener("reset",g)}},[n,x]),e.jsx(_.button,{type:"button",role:"checkbox","aria-checked":C(d)?"mixed":d,"aria-required":u,"data-state":ue(d),"data-disabled":c?"":void 0,disabled:c,value:i,...o,ref:b,onKeyDown:B(r,p=>{p.key==="Enter"&&p.preventDefault()}),onClick:B(a,p=>{x(g=>C(g)?!0:!g),f&&j&&(m.current=p.isPropagationStopped(),m.current||p.stopPropagation())})})});ae.displayName=ne;var oe=h.forwardRef((s,r)=>{const{__scopeCheckbox:a,name:o,checked:t,defaultChecked:n,required:i,disabled:c,value:d,onCheckedChange:u,form:l,...x}=s;return e.jsx(We,{__scopeCheckbox:a,checked:t,defaultChecked:n,disabled:c,required:i,onCheckedChange:u,name:o,form:l,value:d,internal_do_not_use_render:({isFormControl:m})=>e.jsxs(e.Fragment,{children:[e.jsx(ae,{...x,ref:r,__scopeCheckbox:a}),m&&e.jsx(de,{__scopeCheckbox:a})]})})});oe.displayName=S;var ie="CheckboxIndicator",ce=h.forwardRef((s,r)=>{const{__scopeCheckbox:a,forceMount:o,...t}=s,n=O(ie,a);return e.jsx(Se,{present:o||C(n.checked)||n.checked===!0,children:e.jsx(_.span,{"data-state":ue(n.checked),"data-disabled":n.disabled?"":void 0,...t,ref:r,style:{pointerEvents:"none",...s.style}})})});ce.displayName=ie;var le="CheckboxBubbleInput",de=h.forwardRef(({__scopeCheckbox:s,...r},a)=>{const{control:o,hasConsumerStoppedPropagationRef:t,checked:n,defaultChecked:i,required:c,disabled:d,name:u,value:l,form:x,bubbleInput:m,setBubbleInput:j}=O(le,s),f=q(a,j),b=je(n),v=be(o);h.useEffect(()=>{const g=m;if(!g)return;const P=window.HTMLInputElement.prototype,M=Object.getOwnPropertyDescriptor(P,"checked").set,me=!t.current;if(b!==n&&M){const pe=new Event("click",{bubbles:me});g.indeterminate=C(n),M.call(g,C(n)?!1:n),g.dispatchEvent(pe)}},[m,b,n,t]);const p=h.useRef(C(n)?!1:n);return e.jsx(_.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??p.current,required:c,disabled:d,name:u,value:l,form:x,...r,tabIndex:-1,ref:f,style:{...r.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});de.displayName=le;function Ye(s){return typeof s=="function"}function C(s){return s==="indeterminate"}function ue(s){return C(s)?"indeterminate":s?"checked":"unchecked"}const Ze=({className:s,...r})=>e.jsx(oe,{"data-slot":"checkbox",className:T("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...r,children:e.jsx(ce,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:e.jsx(Ce,{className:"size-3.5"})})}),he=({className:s,...r})=>e.jsx("div",{"data-slot":"skeleton",className:T("bg-accent animate-pulse rounded-md",s),...r}),xe=({exercise:s,className:r,checkboxProps:a,checked:o,defaultChecked:t,onCheckedChange:n,disabled:i,...c})=>e.jsxs(ve,{"data-disabled":i,"data-state":o||t?"checked":"unchecked",className:T("flex items-start gap-3 rounded-lg border p-3 bg-secondary/20 has-aria-checked:border-primary has-aria-checked:bg-primary/10 cursor-pointer data-disabled:opacity-50 data-disabled:cursor-not-allowed",r),...c,children:[e.jsx(Ze,{disabled:i,checked:o,defaultChecked:t,onCheckedChange:n,...a}),e.jsxs("div",{className:"grid gap-1.5 font-normal",children:[e.jsx("p",{className:"text-sm leading-none font-medium",children:s.name}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s.muscleGroup.label})]})]}),Q=()=>Pe(k.getAll())>0,es=({trainingProgram:s,...r})=>{const a=F(),o=Q(),{mutateAsync:t,isPending:n}=D({mutationFn:I.delete}),i=async()=>{const{toast:c}=await A(async()=>{const{toast:u}=await import("./index-CzvuFs9p.js").then(l=>l.au);return{toast:u}},__vite__mapDeps([0,1])),{error:d}=await R(t(s.id));if(d){c.error(d.message);return}await a.invalidateQueries(k.getAll()),c.success(`Программа «${s.name}» удалена`)};return e.jsx(Fe,{...r,children:e.jsxs(Ie,{children:[e.jsxs(Ae,{children:[e.jsxs(De,{children:["Удалить программу «",s.name,"»?"]}),e.jsx(Re,{children:"Это действие не может быть отменено. Это удалит программу навсегда."})]}),e.jsxs(Oe,{children:[e.jsx(Qe,{children:"Отмена"}),e.jsx(y,{loading:n||o,onClick:i,children:"Удалить"})]})]})})},ss=({trainingProgram:s,...r})=>e.jsx(W,{...r,children:e.jsxs(Y,{side:"bottom",className:"h-[80vh] rounded-t-xl",children:[e.jsx(Z,{className:"border-b",children:e.jsx(ee,{children:"Новая программа"})}),e.jsx(ts,{trainingProgram:s,onOpenChange:r?.onOpenChange})]})}),ts=({trainingProgram:s,onOpenChange:r})=>{const a=F(),o=h.useId(),t=z({resolver:te(ke),defaultValues:{name:s.name,exerciseIds:s.exercises.map(l=>l.id)}}),n=Q(),i=D({mutationFn:I.update}),c=re(V.getAll()),d=c.data??[],u=async l=>{const{toast:x}=await A(async()=>{const{toast:f}=await import("./index-CzvuFs9p.js").then(b=>b.au);return{toast:f}},__vite__mapDeps([0,1])),{error:m,response:j}=await R(i.mutateAsync({id:s.id,dto:l}));if(m){x.error(m.message);return}await a.invalidateQueries(k.getAll()),x.success(`Программа «${j.data.name}» изменена`),r?.(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(H,{...t,children:e.jsxs("form",{id:o,className:"px-4 flex-1 min-h-0 flex flex-col gap-6",onSubmit:t.handleSubmit(u),children:[e.jsx($,{name:"name",label:"Название программы",inputProps:{placeholder:"Например: День ног"}}),e.jsx(U,{control:t.control,name:"exerciseIds",render:({field:l})=>e.jsxs(G,{className:"flex-1 min-h-0 flex! flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(K,{children:"Выберите упражнения"}),e.jsxs(w,{variant:"secondary",children:[l.value.length," выбрано"]})]}),e.jsx(rs,{isFetching:c.isFetching,exercises:d,value:l.value,onChange:l.onChange}),e.jsx(X,{})]})})]})}),e.jsx(se,{className:"border-t",children:e.jsx(y,{className:"w-full",type:"submit",form:o,loading:i.isPending||n,children:"Изменить"})})]})},rs=({isFetching:s,exercises:r,value:a,onChange:o})=>s?e.jsx(N,{className:"h-full flex-1 min-h-0",children:e.jsx("div",{className:"flex flex-col gap-2",children:Array.from({length:10}).map((t,n)=>e.jsx(he,{className:"h-[66px] w-full rounded-lg"},n))})}):e.jsx(J,{children:r.length?e.jsx(N,{className:"h-full flex-1 min-h-0",children:e.jsx("div",{className:"flex flex-col gap-2",children:r.map(t=>e.jsx(xe,{exercise:t,checked:a.includes(t.id),onCheckedChange:n=>{const i=n?[...a,t.id]:a.filter(c=>c!==t.id);o(i)}},t.id))})}):e.jsx("div",{className:"text-center py-8 border rounded-lg border-dashed",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Сначала создайте упражнения"})})}),ns=({trainingProgram:s,...r})=>{const[a,o]=h.useState(!1),t=a?s.exercises:s.exercises.slice(0,3),n=a?"Скрыть":` +${s.exercises.length-3}`,i=()=>{o(c=>!c)};return e.jsxs(He,{...r,children:[e.jsxs($e,{className:"pb-3 flex flex-row items-start justify-between space-y-0",children:[e.jsxs("div",{children:[e.jsx(Ue,{className:"text-lg",children:s.name}),e.jsxs(Ge,{children:[s.exercises.length," упражнений"]})]}),e.jsx(as,{trainingProgram:s})]}),e.jsx(Ke,{className:"pt-0",children:e.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[t.map(c=>e.jsx(w,{variant:"outline",className:"text-[10px]",children:c?.name||"Удалено"},c.id)),s.exercises.length>3&&e.jsx(w,{variant:"outline",className:"text-[10px]",onClick:i,children:n})]})})]},s.id)},as=({trainingProgram:s})=>{const[r,a]=h.useState(!1),[o,t]=h.useState(!1),n=()=>{a(!0)},i=()=>{t(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(Me,{children:[e.jsx(Be,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"icon",children:e.jsx(Le,{})})}),e.jsxs(qe,{side:"bottom",align:"end",children:[e.jsxs(L,{onClick:n,children:[e.jsx(ze,{className:"size-4"}),"Изменить"]}),e.jsxs(L,{variant:"destructive",onClick:i,children:[e.jsx(Ve,{className:"size-4"}),"Удалить"]})]})]}),e.jsx(ss,{trainingProgram:s,open:r,onOpenChange:a}),e.jsx(es,{trainingProgram:s,open:o,onOpenChange:t})]})},os=()=>{const r=Ee(k.getAll()).data.data;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid gap-4",children:r.map(a=>e.jsx(ns,{trainingProgram:a},a.id))})})},is=()=>{const[s,r]=h.useState(!1);return e.jsxs(W,{open:s,onOpenChange:r,children:[e.jsx(_e,{asChild:!0,children:e.jsx(y,{size:"icon",children:e.jsx(Te,{})})}),e.jsxs(Y,{side:"bottom",className:"h-[80vh] rounded-t-xl",children:[e.jsx(Z,{className:"border-b",children:e.jsx(ee,{children:"Новая программа"})}),e.jsx(cs,{setOpen:r})]})]})},cs=({setOpen:s})=>{const r=F(),a=h.useId(),o=z({resolver:te(ye),defaultValues:{name:"",exerciseIds:[]}}),t=Q(),n=D({mutationFn:I.create}),i=re(V.getAll()),c=i.data??[],d=async u=>{const{toast:l}=await A(async()=>{const{toast:j}=await import("./index-CzvuFs9p.js").then(f=>f.au);return{toast:j}},__vite__mapDeps([0,1])),{error:x,response:m}=await R(n.mutateAsync(u));if(x){l.error(x.message);return}await r.invalidateQueries(k.getAll()),l.success(`Программа «${m.data.name}» создана`),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(H,{...o,children:e.jsxs("form",{id:a,className:"px-4 flex-1 min-h-0 flex flex-col gap-6",onSubmit:o.handleSubmit(d),children:[e.jsx($,{name:"name",label:"Название программы",inputProps:{placeholder:"Например: День ног"}}),e.jsx(U,{control:o.control,name:"exerciseIds",render:({field:u})=>e.jsxs(G,{className:"flex-1 min-h-0 flex! flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(K,{children:"Выберите упражнения"}),e.jsxs(w,{variant:"secondary",children:[u.value.length," выбрано"]})]}),e.jsx(ls,{isFetching:i.isFetching,exercises:c,value:u.value,onChange:u.onChange}),e.jsx(X,{})]})})]})}),e.jsx(se,{className:"border-t",children:e.jsx(y,{className:"w-full",type:"submit",form:a,loading:n.isPending||t,children:"Создать программу"})})]})},ls=({isFetching:s,exercises:r,value:a,onChange:o})=>s?e.jsx(N,{className:"h-full flex-1 min-h-0",children:e.jsx("div",{className:"flex flex-col gap-2",children:Array.from({length:10}).map((t,n)=>e.jsx(he,{className:"h-[66px] w-full rounded-lg"},n))})}):e.jsx(J,{children:r.length?e.jsx(N,{className:"h-full flex-1 min-h-0",children:e.jsx("div",{className:"flex flex-col gap-2",children:r.map(t=>e.jsx(xe,{exercise:t,checked:a.includes(t.id),onCheckedChange:n=>{const i=n?[...a,t.id]:a.filter(c=>c!==t.id);o(i)}},t.id))})}):e.jsx("div",{className:"text-center py-8 border rounded-lg border-dashed",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Сначала создайте упражнения"})})}),ms=()=>e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between sticky top-0 bg-background z-10 py-4",children:[e.jsx("h1",{className:"text-h2",children:"Программы тренировок"}),e.jsx(is,{})]}),e.jsx(os,{})]});export{ms as component};
